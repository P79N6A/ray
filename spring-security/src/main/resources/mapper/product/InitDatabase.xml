<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- Mybatis mapper for file  Auto generated by fms-mybatis-generator -->
<mapper namespace="com.rongyi.hla.mapper.product.InitDatabaseMapper">

    <!--<resultMap id="file" type="com.rongyi.model.product.File">-->
    <!--<id property="id" column="file_id" javaType="int" jdbcType="INTEGER" />-->
    <!--<result property="url" column="file_url" javaType="string" jdbcType="VARCHAR" />-->
    <!--<result property="path" column="file_path" javaType="string" jdbcType="VARCHAR" />-->
    <!--<result property="name" column="file_name" javaType="string" jdbcType="VARCHAR" />-->
    <!--<result property="suffix" column="file_suffix" javaType="string" jdbcType="VARCHAR" />-->
    <!--<result property="createDate" column="file_create_date" javaType="java.util.Date" jdbcType="TIMESTAMP" />-->
    <!--</resultMap>-->


    <!--<select id="get" parameterType="int" resultMap="file">-->
    <!--SELECT <include refid="sqlfileColumns" />-->
    <!--FROM file file_-->
    <!--WHERE file_.id = #{id,jdbcType=INTEGER}-->
    <!--</select>-->

    <!--获取是否有这个数据库-->
    <select id="getDatabase" parameterType="string" resultType="map">
        SELECT * FROM information_schema.SCHEMATA WHERE SCHEMA_NAME=#{dbName };
    </select>

    <select id="getTable" parameterType="string" resultType="map">
        select * from INFORMATION_SCHEMA.TABLES where TABLE_SCHEMA=#{dbName } and TABLE_NAME=#{tableName };
    </select>

    <!--创建指定名称的数据库，字符集用utf8-->
    <insert id="createDatabase">
        create  schema  ${dbName } default character set utf8 collate utf8_general_ci ;
    </insert>





    <!--建表-->
    <insert id="createTableForFile">
        CREATE TABLE `file` (
          `id` int(255) NOT NULL AUTO_INCREMENT,
          `url` varchar(255) DEFAULT NULL COMMENT '图片地址',
          `path` varchar(255) DEFAULT NULL COMMENT '图片本地地址',
          `name` varchar(255) DEFAULT NULL COMMENT '名称',
          `suffix` varchar(10) DEFAULT NULL COMMENT '后缀',
          `create_date` datetime DEFAULT NULL COMMENT '记录时间',
          PRIMARY KEY (`id`)
        ) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8;
    </insert>

    <!--建表product-->
    <insert id="createTableForProduct">
        CREATE TABLE `product` (
          `id` int(20) NOT NULL AUTO_INCREMENT COMMENT '主键',
          `rfid_code` varchar(100) DEFAULT NULL COMMENT '近场通讯编码',
          `sku_code` varchar(100) DEFAULT NULL COMMENT 'SKU编码',
          `spu_code` varchar(100) DEFAULT NULL COMMENT 'SPU编码',
          `price` int(100) DEFAULT NULL COMMENT 'sku显示价格（100X）',
          `name` varchar(100) DEFAULT NULL COMMENT '商品名称sku',
          `subtitle` varchar(100) DEFAULT NULL COMMENT '商品副标题/英文名称',
          `notes` varchar(255) DEFAULT NULL COMMENT 'sku商品描述',
          `image` varchar(255) DEFAULT NULL COMMENT '默认主图default',
          `state` tinyint(1) DEFAULT NULL COMMENT '是否可以展示【可编辑】',
          `origin_place` varchar(255) DEFAULT NULL COMMENT '原产地【可编辑】',
          `material` varchar(20) DEFAULT NULL COMMENT '材质【可编辑】',
          `short_notes` varchar(255) DEFAULT NULL COMMENT '商品简介',
          `param_1` varchar(255) DEFAULT NULL COMMENT '预留参数1',
          `param_2` varchar(255) DEFAULT NULL COMMENT '预留参数2',
          `param_3` varchar(255) DEFAULT NULL COMMENT '预留参数3',
          `create_date` datetime DEFAULT NULL COMMENT '创建时间',
          `update_date` datetime DEFAULT NULL COMMENT '更新时间',
          PRIMARY KEY (`id`),
          UNIQUE KEY `sku_code` (`sku_code`)
        ) ENGINE=InnoDB DEFAULT CHARSET=utf8 ROW_FORMAT=COMPACT COMMENT='产品表';
    </insert>

    <!--建表spu-->
    <insert id="createTableForProductSpu">
      CREATE TABLE `product_spu` (
      `id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'spuid',
      `spu_code` varchar(255) NOT NULL COMMENT 'SPU编码',
      `name` varchar(100) DEFAULT NULL COMMENT 'spu商品名称',
      `price` int(11) DEFAULT '0' COMMENT 'spu商品售价',
      `notes` varchar(255) DEFAULT NULL COMMENT 'spu商品描述',
      `state` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'spu商品状态  0=false、1=true',
      `image` varchar(255) DEFAULT NULL COMMENT 'spu商品图片',
      `origin_place` varchar(255) DEFAULT NULL COMMENT '原产地【可编辑】',
      `material` varchar(255) DEFAULT NULL COMMENT '材质【可编辑】',
      `create_date` datetime DEFAULT NULL,
      `update_date` datetime DEFAULT NULL,
      PRIMARY KEY (`id`),
      UNIQUE KEY `spu_code` (`spu_code`)
    ) ENGINE=InnoDB AUTO_INCREMENT=275 DEFAULT CHARSET=utf8 COMMENT='SPU';
    </insert>

    <!--建表group-->
    <insert id="createTableForProductGroup">
        CREATE TABLE `product_group` (
          `id` int(11) NOT NULL AUTO_INCREMENT,
          `code` varchar(255) DEFAULT NULL COMMENT '分组编码',
          `parent_code` varchar(255) DEFAULT NULL COMMENT '父级编码',
          `name` varchar(255) DEFAULT NULL COMMENT '分组产品名称（如：衬衫）',
          `image` varchar(255) DEFAULT NULL COMMENT '分组产品图片',
          `typeZhName` varchar(255) DEFAULT NULL COMMENT '类型 手工分组',
          `notes` varchar(255) DEFAULT NULL COMMENT '简介',
          PRIMARY KEY (`id`),
          UNIQUE KEY `code` (`code`)
        ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='产品分类(组)表';
    </insert>

    <!--建表关联表group-spu-->
    <insert id="createTableForProductGroupSpu">
        CREATE TABLE `group_spu` (
          `spu_code` varchar(255) NOT NULL,
          `group_code` varchar(255) NOT NULL,
          `group_name` varchar(255) DEFAULT NULL COMMENT '组名称',
          PRIMARY KEY (`spu_code`,`group_code`)
        ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='分组-spu多对多关联用表';

    </insert>

    <!--建表token-->
    <insert id="createTableForToken">
        CREATE TABLE `token` (
          `id` int(11) NOT NULL AUTO_INCREMENT,
          `token` varchar(100) DEFAULT NULL COMMENT 'token',
          `create_date` datetime DEFAULT NULL COMMENT '创建时间',
          `expires_time` bigint(40) DEFAULT NULL COMMENT '过期时间 单位：ms（毫秒）',
          `access_token_url` varchar(255) DEFAULT NULL COMMENT '获取token的地址',
          `app_id` varchar(100) DEFAULT NULL COMMENT 'appid',
          `app_secret` varchar(100) DEFAULT NULL COMMENT 'appSecret',
          `state` int(11) DEFAULT NULL COMMENT '状态',
          PRIMARY KEY (`id`)
        ) ENGINE=InnoDB DEFAULT CHARSET=utf8;
    </insert>

    <!--建表pull_log-->
    <insert id="createTableForPullLog">
        CREATE TABLE `pull_log` (
          `id` int(20) NOT NULL AUTO_INCREMENT COMMENT '日志主键',
          `success` tinyint(4) DEFAULT NULL COMMENT '状态码成功与否',
          `name` varchar(100) DEFAULT NULL COMMENT '操作名称',
          `source_address` varchar(100) DEFAULT NULL COMMENT '操作的资源地址',
          `operator` varchar(100) DEFAULT NULL COMMENT '操作者名称',
          `remark` varchar(225) DEFAULT NULL COMMENT '操作备注',
          `success_quantity` int(11) DEFAULT '0' COMMENT '成功数量  successQuantity=updateQuantity+saveQuantity',
          `update_quantity` int(11) DEFAULT '0' COMMENT '更新数量',
          `insert_quantity` int(11) DEFAULT NULL,
          `request_date` datetime DEFAULT NULL COMMENT '任务请求时刻',
          `create_date` datetime DEFAULT NULL COMMENT '创建时间',
          `url` varchar(225) DEFAULT NULL COMMENT '操作者的HOST',
          PRIMARY KEY (`id`),
          KEY `id` (`id`) USING BTREE
        ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='产品表';
    </insert>

</mapper>
