<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- Mybatis mapper for product_spu  Auto generated by fms-mybatis-generator -->
<mapper namespace="com.rongyi.hla.mapper.product.ProductSpuMapper">
    <resultMap id="product_spu" type="com.rongyi.model.product.ProductSpu">
        <id property="id" column="pt_id" javaType="int" jdbcType="INTEGER"/>
        <result property="spuCode" column="pt_spu_code" javaType="string" jdbcType="VARCHAR"/>
        <result property="name" column="pt_name" javaType="string" jdbcType="VARCHAR"/>
        <result property="price" column="pt_price" javaType="int" jdbcType="INTEGER"/>
        <result property="notes" column="pt_notes" javaType="string" jdbcType="VARCHAR"/>
        <result property="state" column="pt_state" javaType="boolean" jdbcType="TINYINT"/>
        <result property="image" column="pt_image" javaType="string" jdbcType="VARCHAR"/>
    </resultMap>

    <sql id="sqlproduct_spuColumns">
		pt_.id AS pt_id,
		pt_.spu_code AS pt_spu_code,
		pt_.name AS pt_name,
		(pt_.price)/100 AS pt_price,
		pt_.notes AS pt_notes,
		pt_.state AS pt_state,
		pt_.image AS pt_image
	</sql>
    <select id="get" parameterType="int" resultMap="product_spu">
        SELECT
        <include refid="sqlproduct_spuColumns"/>
        FROM product_spu pt_
        WHERE pt_.id = #{id,jdbcType=INTEGER}
    </select>


    <select id="list"  resultMap="product_spu">
        SELECT
        <include refid="sqlproduct_spuColumns"/>
        FROM product_spu pt_
    </select>



    <select id="selectForPage" parameterType="com.rongyi.dto.query.SpuQueryDTO" resultMap="product_spu">
        SELECT
        <include refid="sqlproduct_spuColumns"/>
        FROM product_spu pt_
        <where>
            <if test="name != null and name != ''"> pt_.`name`= #{name,jdbcType=VARCHAR}</if>
        </where>
        LIMIT #{offSet},#{pageSize};
    </select>

    <select id="selectPageCount"  parameterType="com.rongyi.dto.query.SpuQueryDTO"  resultType="java.lang.Integer">
        SELECT COUNT(pt_.id)      FROM product_spu pt_
        <where>
            <if test="name != null and name != ''"> pt_.`name`= #{name,jdbcType=VARCHAR}</if>
        </where>
    </select>







    <select id="selectAll" resultMap="product_spu">
        SELECT
        <include refid="sqlproduct_spuColumns"/>
        FROM product_spu pt_
    </select>

    <select id="getTotalCount" resultType="java.lang.Integer">
        SELECT       COUNT(id)       FROM    product_spu
    </select>

    <insert id="save" parameterType="com.rongyi.model.product.ProductSpu" useGeneratedKeys="true" keyProperty="id">
		INSERT INTO product_spu (
		    spu_code,
			`name`,
			price,
			notes,
			state,
			image
		)
        VALUES (
			#{spuCode,jdbcType=VARCHAR},
			#{name,jdbcType=VARCHAR},
			#{price,jdbcType=INTEGER}*100,
			#{notes,jdbcType=VARCHAR},
			#{state,jdbcType=TINYINT},
			#{image,jdbcType=VARCHAR}
		)
	</insert>

    <update id="update" parameterType="com.rongyi.model.product.ProductSpu">
        UPDATE product_spu
        <set>
            <if test="state != null">state = #{state,jdbcType=TINYINT},</if>
        </set>
        WHERE id = #{id,jdbcType=INTEGER}
    </update>
</mapper>
