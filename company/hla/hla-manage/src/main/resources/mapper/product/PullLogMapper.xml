<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- Mybatis mapper for pull_log  Auto generated by fms-mybatis-generator -->
<mapper namespace="com.rongyi.hla.mapper.product.PullLogMapper">
    <resultMap id="pull_log" type="com.rongyi.entity.product.PullLog">
        <id property="id" column="pull_log_id" javaType="integer" jdbcType="INTEGER"/>
        <result property="name" column="pull_log_name" javaType="string" jdbcType="VARCHAR"/>
        <result property="success" column="pull_log_success" javaType="boolean" jdbcType="INTEGER"/>

        <result property="sourceAddress" column="pull_log_source_address" javaType="string" jdbcType="VARCHAR"/>
        <result property="remark" column="pull_log_remark" javaType="string" jdbcType="VARCHAR"/>
        <result property="url" column="pull_log_url" javaType="string" jdbcType="VARCHAR"/>

        <result property="operator" column="pull_log_operator" javaType="string" jdbcType="VARCHAR"/>
        <result property="createDate" column="pull_log_create_date" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="requestDate" column="pull_log_request_date" javaType="java.util.Date" jdbcType="TIMESTAMP"/>

        <result property="successQuantity" column="pull_log_success_quantity" javaType="int" jdbcType="INTEGER"/>
        <result property="updateQuantity" column="pull_log_update_quantity" javaType="int" jdbcType="INTEGER"/>
        <result property="insertQuantity" column="pull_log_insert_quantity" javaType="int" jdbcType="INTEGER"/>


    </resultMap>

    <sql id="sql_pull_logColumns">
		pull_log_.id AS pull_log_id,
		pull_log_.`name` AS pull_log_name,
		pull_log_.success AS pull_log_success,

		pull_log_.source_address AS pull_log_source_address,
		pull_log_.remark AS pull_log_remark,
		pull_log_.url AS pull_log_url,

		pull_log_.operator AS pull_log_operator,
		pull_log_.create_date AS pull_log_create_date,
		pull_log_.request_date AS pull_log_request_date,

		pull_log_.success_quantity AS pull_log_success_quantity,
		pull_log_.update_quantity AS pull_log_update_quantity,
		pull_log_.insert_quantity AS pull_log_insert_quantity
	</sql>

    <select id="get" parameterType="integer" resultMap="pull_log">
        SELECT
        <include refid="sql_pull_logColumns"/>
        FROM pull_log pull_log_
        WHERE pull_log_.id = #{id,jdbcType=INTEGER}
    </select>


    <select id="getLatestRequest" parameterType="string" resultMap="pull_log">
        SELECT        <include refid="sql_pull_logColumns"/>
        FROM pull_log AS pull_log_
        WHERE pull_log_.`name`=	#{name,jdbcType=VARCHAR} AND  pull_log_.request_date IS NOT NULL
        ORDER BY pull_log_.request_date DESC
        limit 1
        ;

    </select>


    <select id="selectAll" resultMap="pull_log">
        SELECT
        <include refid="sql_pull_logColumns"/>
        FROM pull_log pull_log_
    </select>

    <insert id="save" parameterType="com.rongyi.entity.product.PullLog" useGeneratedKeys="true" keyProperty="id">
		INSERT INTO pull_log (
			success,
			`name`,
			source_address,

			operator,
			remark,
			url,

			success_quantity,
			update_quantity,
			insert_quantity,

			request_date,
			create_date
		)
        VALUES (

			#{success},
			#{name,jdbcType=VARCHAR},
			#{sourceAddress,jdbcType=VARCHAR},

			#{operator,jdbcType=VARCHAR},
			#{remark,jdbcType=VARCHAR},
			#{url,jdbcType=VARCHAR},

			#{successQuantity,jdbcType=VARCHAR},
			#{updateQuantity,jdbcType=VARCHAR},
			#{insertQuantity,jdbcType=VARCHAR},

			#{requestDate,jdbcType=TIMESTAMP},
			now()
		)
	</insert>

    <update id="update" parameterType="com.rongyi.entity.product.PullLog">
        UPDATE pull_log
        <set>
            <if test="success != null">success = #{success},</if>
            <if test="name != null and name != ''">`name` = #{name,jdbcType=VARCHAR},</if>
            <if test="sourceAddress != null and sourceAddress != ''">source_address = #{sourceAddress,jdbcType=VARCHAR},</if>
            <if test="operator != null and operator != ''">operator = #{operator,jdbcType=VARCHAR},</if>
            <if test="remark != null and remark != ''">remark = #{remark,jdbcType=VARCHAR},</if>
            <if test="url != null and url != ''">url = #{url,jdbcType=VARCHAR},</if>
            <if test="createDate != null">create_date = #{createDate,jdbcType=TIMESTAMP},</if>
            <if test="requestDate != null">request_date = #{createDate,jdbcType=TIMESTAMP},</if>
        </set>
        WHERE id = #{id,jdbcType=INTEGER}
    </update>

</mapper>
